

import pickle
import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.metrics import precision_score
from sklearn.metrics import recall_score
from nltk.tokenize import sent_tokenize, word_tokenize
from nltk import ngrams
import sklearn.metrics as metrics
import tensorflow as tf

NUM_LABELS = 7
NUM_FEATURES = 700
BATCH_SIZE = 500
EPOCHS = 20


DATA = {}
FILES_PER_LABEL = {}
#VOCAB = {"this", "In", "we", "can", "data", "We", "it", "method", "such", "algorithm", "our", "new", "show", "two", "approach", "computer", "information", "present", "one", "methods", "applications", "problem", "propose", "To", "number", "algorithms", "software", "each", "provide", "processing", "computing", "many", "Our", "set", "large", "learning", "techniques", "image", "some", "several", "security", "existing", "various", "efficient", "while", "problems", "solutions", "features", "demonstrate", "programming", "parallel", "distributed", "framework", "where", "implementation", "structures", "provides", "accuracy", "improve", "multiple", "complex", "then", "computational", "better", "key", "very", "experiments", "computation", "approaches", "any", "them", "same", "real", "images", "available", "networks", "detection", "As", "terms", "result", "possible", "need", "tool", "knowledge", "so", "user", "allows", "evaluation", "way", "traditional", "space", "With", "functions", "Moreover", "databases", "users", "called", "vision", "tools", "database", "types", "architecture", "particular", "classification", "feature", "able", "best", "complexity", "improved", "widely", "Therefore", "standard", "become", "help", "requirements", "access", "solve", "uses", "make", "domain", "even", "tasks", "By", "find", "issues", "describe", "develop", "generated", "graphics", "useful", "platform", "state-of-the-art", "datasets", "thus", "analyze", "code", "challenges", "relational", "sets", "perform", "attacks", "introduce", "address", "hardware", "language", "search", "like", "operations", "still", "requires", "challenging", "detect", "nodes", "symbolic", "difficult", "open", "program", "bioinformatics", "much", "efficiently", "services", "makes", "providing", "mobile", "environments", "effectively", "selection", "visual", "needs", "generate", "random", "fields", "objects", "automatically", "virtual", "&", "issue", "statistical", "variety", "execution", "solving", "schemes", "training", "implement", "certain", "challenge", "does", "basic", "cloud", "since", "allow", "times", "interface", "require", "making", "consider", "researchers", "attack", "prediction", "online", "compare", "Wiley", "object", "create", "secure", "goal", "original", "enables", "Internet", "One", "class", "automatic", "large-scale", "popular", "interest", "apply", "experiment", "vector", "transformation", "dataset", "complete", "heterogeneous", "resource", "construct", "query", "easily", "usually", "protocol", "respect", "service", "automated", "running", "view", "modern", "applying", "works", "concepts", "scalability", "platforms", "optical", "mapping", "cryptography", "namely", "domains", "traffic", "Sons", "us", "science", "version", "Copyright", "John", "enable", "give", "increasingly", "represent", "created", "take", "real-world", "easy", "prove", "powerful", "extensive", "big", "distance", "extracted", "capable", "generalized", "improves", "etc", "Computer", "Many", "faster", "scientific", "map", "analyzing", "extraction", "wireless", "node", "achieves", "capabilities", "teaching", "architectures", "overcome", "outperforms", "usage", "web", "compute", "protocols", "transform", "benchmark", "propagation", "mining", "steps", "extract", "rules", "stored", "cluster", "exact", "handle", "hand", "overhead", "Software", "Such", "learn", "probability", "computed", "build", "facilitate", "camera", "clustering", "scalable", "run", "ones", "validation", "interactive", "queries", "collection", "requirement", "shared", "visualization", "becomes", "matching", "GPU", "tree", "background", "idea", "scheduling", "implementations", "partial", "deal", "introduces", "capture", "define", "extend", "every", "classes", "segmentation", "supports", "structured", "get", "classifier", "avoid", "binary", "languages", "takes", "combining", "interesting", "Recently", "iterative", "malicious", "typically", "kind", "well-known", "server", "synthetic", "CPU", "et", "detecting", "sharing", "soliton", "proved", "performing", "deep", "sparse", "effort", "allowing", "encryption", "decomposition", "similarity", "instead", "reconstruction", "pair", "throughput", "manage", "operators", "exist", "always", "kernel", "exploit", "combines", "retrieval", "Through", "huge", "derive", "Network", "color", "creating", "arbitrary", "contains", "realistic", "performs", "attributes", "i", "coding", "curve", "developers", "involves", "captured", "clusters", "extension", "topic", "becoming", "integrate", "file", "solitons", "al", "text", "formal", "art", "authentication", "computationally", "aid", "approximate", "Experiments", "library", "rely", "Second", "bilinear", "kinds", "business", "sizes", "store", "manual", "enough", "generic", "quantum", "correct", "representing", "handling", "representations", "hierarchical", "applicable", "today", "metrics", "details", "format", "processors", "computations", "graphs", "maps", "deployment", "Some", "Besides", "applicability", "allocation", "fusion", "graphical", "massive", "processed", "modules", "bound", "Linux", "named", "files", "creation", "deployed", "weighted", "secret", "guarantee", "definition", "privacy", "computers", "edge", "expensive", "-dimensional", "runtime", "share", "Under", "Hirota", "operator", "proposal", "explicit", "unified", "cryptographic", "dynamically", "texture", "message", "update", "subset", "functionality", "threats", "package", "acquired", "interfaces", "exploiting", "semantic", "Information", "latter", "select", "employ", "table", "GPUs", "classify", "scene", "Systems", "maintaining", "put", "display", "Programming", "algebra", "and", ")", "(", "were", "was", "study", ":", "patients", "%", "Results", ";", "associated", "may", "treatment", "Methods", "disease", "significant", "significantly", "=", "clinical", "had", "years", "compared", "increased", "risk", "after", "age", "all", "Conclusions", "higher", "Background", "2", "health", "most", "1", "<", "no", "factors", "group", "total", "included", "reported", "Conclusion", "groups", "3", "lower", "performed", "therapy", "care", "respectively", "symptoms", "common", "patient", "assessed", "population", "should", "without", "women", "p", "conducted", "aim", "95", "2017", "There", "outcomes", "association", "diagnosis", "changes", "evaluated", "mean", "diseases", "chronic", "P", "evaluate", "Objective", "primary", "assess", "determine", "[", "]", "10", "regression", "months", "investigate", "decreased", "measured", "4", "reduced", "CI", "healthy", "identify", "cases", "period", "6", "5", "type", "treated", "prevalence", "aimed", "Patients", "12", "status", "rates", "following", "efficacy", "n", "controls", "follow-up", "Health", "medical", "intervention", "baseline", "body", "cohort", "before", ">", "+/-", "outcome", "0.001", "days", "loss", "subjects", "inflammatory", "collected", "aged", "score", "needed", "confidence", "syndrome", "drug", "overall", "criteria", "difference", "weeks", "received", "severe", "weight", "index", "history", "Data", "limited", "incidence", "30", "followed", "pain", "20", "per", "interval", "serum", "skin", "0.05", "acute", "50", "practice", "adverse", "diagnosed", "severity", "events", "least", "randomized", "correlated", "After", "prevention", "year", "trials", "long-term", "No", "sex", "diabetes", "according", "mortality", "questionnaire", "8", "cross-sectional", "survey", "Of", "independent", "and/or", "bone", "injury", "drugs", "older", "7", "Objectives", "15", "Among", "poor", "inflammation", "odds", "safety", "duration", "18", "affected", "underwent", "correlation", "Purpose", "24", "imaging", "logistic", "daily", "trial", "median", "defined", "diagnostic", "prospective", "At", "having", "statistically", "enrolled", "treatments", "OR", "25", "versus", "cardiovascular", "Introduction", "vs.", "secondary", "oral", "dysfunction", "frequently", "retrospective", "arthritis", "surgery", "hospital", "14", "complications", "40", "National", "administration", "majority", "dose", "prevent", "birth", "smoking", "pregnancy", "60", "injuries", "seen", "elevated", "recruited", "published", "9", "onset", "0.01", "causes", "11", "16", "administered", "adjusted", "therapies", "commonly", "heart", "Clinical", "living", "rare", "moderate", "13", "reviewed", "death", "frequent", "impairment", "Most", "profile", "hormone", "occurred", "agents", "burden", "17", "recorded", "systematic", "Both", "day", "pulmonary", "benefit", "proportion", "lung", "United", "Alzheimer", "bowel", "systemic", "beta", "2012", "unclear", "symptom", "emergency", "clinically", "receiving", "asthma", "setting", "obesity", "headache", "RESULTS", "guidelines", "rats", "surgical", "involvement", "medication", "HIV", "analysed", "multivariate", "demographic", "States", "remained", "sleep", "side", "contraception", "recommended", "examination", "peripheral", "beneficial", "21", "METHODS", "week", "19", "mild", "old", "alone", "fungal", "Compared", "vs", "delivery", "joint", "treat", "Parkinson", "independently", "risks", "prevalent", "safe", "randomly", "January", "longer", "fibrosis", "AD", "divided", "ratios", "healthcare", "28", "deficiency", "recommendations", "35", "90", "national", "morbidity", "testosterone", "serious", "allergies", "22", "consecutive", "31", "percentage", "diet", "resonance", "inclusion", "lesions", "Index", "During", "hundred", "occurrence", "2010", "intake", "urinary", "80", "improvements", "gastrointestinal", "Women", "hypertension", "BMI", "23", "sought", "medications", "respiratory", "Treatment", "protective", "SD", "osteoporosis", "65", "sports", "parenting", "dementia", "bladder", "vascular", "met", "adjustment", "70", "observational", "More", "treating", "options", "US", "allergic", "records", "presentation", "Aim", "Survey", "stimulation", "32", "younger", "45", "tract", "clinic", "autoimmune", "tomography", "sclerosis", "decline", "matched", "contraceptive", "classified", "placebo", "receive", "agent", "27", "percent", "26", "doses", "36", "replacement", "rheumatoid", "providers", "dermatitis", "Hospital", "comparable", "Only", "undergoing", "exercise", "substantial", "pathology", "cardiac", "Medical", "adjusting", "elderly", "reproductive", "48", "month", "standardized", "sustained", "articles", "PD", "75", "thyroid", "migraine", "BACKGROUND", "abnormalities", "pediatric", "eight", "cessation", "pathological", "Disease", "pathophysiology", "necrosis", "idiopathic", "hazard", "progressive", "comorbidities", "Chinese", "adherence", "December", "searched", "Mean", "menopause", "hypothyroidism", "abnormal", "0.0001", "half", "clinicians", "mg", "disability", "psoriasis", "mellitus", "neurons", "PubMed", "CONCLUSIONS", "routine", "42", "pharmacological", "presenting", "intervals", "stroke", "29", "breast", "retrospectively", "documented", "hours", "neurological", "nervous", "anti-inflammatory", "New", "meta-analysis", "until", "hepatitis", "psoriatic", "MRI", "initiation", "Association", "Aims", "55", "option", "aging", "visits", "white", "III", "All", "water", "different", "use", "construction", "through", "management", "development", "under", "potential", "due", "building", "material", "area", "environmental", "three", "application", "environment", "over", "main", "field", "technology", "harvesting", "increase", "case", "quality", "B.V.", "areas", "pollution", "effective", "green", "smart", "rainwater", "project", "change", "solar", "soil", "bridge", "monitoring", "future", "geotextile", "analyzed", "2015", "sensing", "projects", "increasing", "sustainable", "natural", "up", "buildings", "tests", "remote", "resources", "structural", "local", "value", "assessment", "indicate", "suspension", "made", "technologies", "capacity", "industry", "Based", "demand", "spatial", "purpose", "2014", "activities", "urban", "economic", "average", "China", "region", "global", "ambient", "scale", "sources", "climate", "land", "impacts", "aims", "Water", "storage", "rainfall", "-", "objective", "concentration", "improvement", "layer", "sensors", "alternative", "sustainability", "2013", "benefits", "mainly", "promising", "bridges", "composite", "series", "amount", "planning", "appropriate", "world", "great", "costs", "Society", "practices", "carbon", "estimated", "enhance", "countries", "scenarios", "intelligence", "around", "adopted", "Authors", "constructed", "runoff", "highest", "American", "Ambient", "Engineers", "vertical", "decision", "long", "absorption", "waste", "reducing", "mm", "cover", "River", "prepared", "Two", "improving", "coefficient", "expected", "organic", "Civil", "vibration", "layers", "ground", "growing", "Building", "Green", "last", "-1", "comprehensive", "degradation", "agricultural", "feasibility", "annual", "stealth", "actual", "dry", "taken", "policy", "intelligent", "Bridge", "located", "reinforced", "contribution", "above", "meet", "irrigation", "wastewater", "damage", "river", "location", "sand", "decades", "protection", "base", "Intelligence", "infrastructure", "ecological", "productivity", "resolution", "section", "utilization", "long-span", "yield", "pH", "drainage", "indicates", "availability", "observations", "reinforcement", "spectral", "displacement", "maintenance", "pollutants", "residential", "concrete", "span", "vegetation", "removal", "intensity", "installed", "trend", "regional", "purposes", "managers", "tank", "domestic", "focuses", "throughout", "top", "conductivity", "policies", "cable", "approximately", "conservation", "city", "i.e", "locations", "balance", "sector", "scenario", "variability", "groundwater", "Rainwater", "RWH", "emerging", "stiffness", "radar", "geotextiles", "home", "successful", "changing", "property", "season", "efforts", "Construction", "foundation", "nitrogen", "indoor", "band", "standards", "radiation", "photocatalytic", "stakeholders", "considerable", "monitored", "roof", "monitor", "synthesized", "clay", "facilities", "metals", "nanoparticles", "cm", "geosynthetic", "technological", "contributes", "situation", "heavy", "establish", "evaluating", "success", "precipitation", "gap", "drinking", "AmI", "objectives", "actuators", "South", "almost", "slope", "placed", "km", "rural", "below", "soils", "indicators", "integrating", "film", "savings", "According", "soft", "harvested", "varied", "thin", "cities", "ii", "agriculture", "deck", "crop", "government", "concluded", "moisture", "achieving", "girder", "demands", "basin", "coastal", "cables", "separation", "periods", "rating", "zones", "contamination", "indices", "ecosystem", "mitigation", "trends", "cross", "civil", "net", "quantify", "ecosystems", "aerodynamic", "erosion", "decreasing", "largest", "infrared", "India", "country", "road", "indicator", "aquatic", "investment", "surrounding", "Environmental", "installation", "Design/methodology/approach", "Originality/value", "ranging", "adoption", "communities", "tunnel", "forest", "plan", "upper", "climatic", "household", "matter", "facing", "comfort", "covered", "landscape", "financial", "scarcity", "international", "tanks", "nonwoven", "visible", "designers", "saving", "certification", "B.V", "summer", "wet", "bearing", "GIS", "SEM", "enhancement", "irradiation", "dominant", "Management", "waters", "suspended", "enhancing", "seasons", "Smart", "quantity", "2000", "practitioners", "lateral", "changed", "BIM", "environmentally", "adaptation", "LEED", "pollutant", "stormwater", "imagery", "watershed", "economy", "innovation", "Africa", "stations", "industries", "historical", "reuse", "assist", "extreme", "mitigate", "managing", "atmospheric", "influencing", "biomass", "alternatives", "potable", "households", "proven", "attributed", "reflectance", "woven", "dissolved", "pavement", "owners", "fiber", "settlement", "Solar", "weather", "tower", "makers", "harvest", "fine", "fibers", "crops", "phosphorus", "regulations", "suitability", "absorber", "facility", "schedule", "retention", "films", "cable-stayed", "spectra", "iii", "displacements", "solids", "catchment", "analyzes", "Soil", "winter", "nutrient", "return", "highlighted", "urbanization", "contractors", "friendly", "housing", "hydrological", "reflection", "collect", "ubiquitous", "geographic", "adopt", "spaces", "efficiencies", "microwave", "surveys", "rain", "semi-arid", "Landsat", "greatest", "identifies", "office", "gradually", "column", "permeability", "Zn", "cyclic", "Remote", "clean", "freshwater", "bands", "monthly", "combinations", "flat", "sewage", "arid", "covering", "farmers", "scope", "homes", "elevation", "torsional", "ions", "polluted", "filtration", "economical", "grown", "adopting", "decade", "evaluates", "recycling", "undertaken", "meteorological", "contaminants", "seismic", "coated", "TiO2", "Cu", "principal", "high-resolution", "rivers", "Australia", "guidance", "anthropogenic", "coating", "bodies", "infiltration", "photocatalyst", "managed", "polypropylene", "is", "are", "paper", "This", "system", "proposed", "using", "control", "power", "A", "model", "performance", "systems", "electrical", "presented", "time", "presents", "current", "energy", "parameters", "order", "simulation", "signal", "circuit", "voltage", "frequency", "controller", "output", "designed", "network", "low", "circuits", "applied", "technique", "dynamic", "input", "electric", "digital", "linear", "range", "operation", "response", "implemented", "state", "load", "nonlinear", "motor", "operational", "conventional", "amplifier", "analog", "solution", "shown", "consumption", "filter", "cost", "electricity", "PID", "simulations", "identification", "optimization", "generation", "stability", "supply", "An", "Finally", "representation", "speed", "optimal", "simple", "effectiveness", "CMOS", "integrated", "given", "generator", "active", "error", "gain", "microcontroller", "components", "operating", "required", "controlled", "scheme", "achieve", "measurement", "phase", "reduce", "converter", "parameter", "feedback", "suitable", "signals", "noise", "derived", "dynamics", "proposes", "devices", "mu", "mode", "achieved", "shows", "m", "transfer", "tested", "example", "strategy", "controllers", "comparison", "introduced", "sensor", "simulated", "source", "device", "estimation", "verified", "theoretical", "provided", "differential", "hybrid", "prototype", "second", "consists", "transmission", "loop", "obtain", "graph", "employed", "tracking", "equivalent", "accurate", "mathematical", "robust", "practical", "advantages", "described", "wind", "fast", "state-space", "grid", "procedure", "adaptive", "sensitivity", "Then", "elements", "unit", "concept", "matrix", "connected", "Simulation", "describes", "drive", "integration", "reference", "validated", "switching", "configuration", "electronic", "external", "estimate", "corresponding", "coupled", "considering", "direct", "DC", "constant", "bandwidth", "delay", "constraints", "stage", "examples", "V", "step", "directly", "Experimental", "tuning", "passive", "variable", "impedance", "renewable", "transient", "conversion", "additional", "continuous", "Control", "radio", "robustness", "verify", "desired", "built", "fuzzy", "capability", "topology", "motion", "minimum", "stable", "experimentally", "advantage", "magnetic", "optimized", "performances", "converters", "turbine", "capacitor", "filters", "reliability", "compensation", "classical", "loads", "First", "position", "coupling", "validate", "modified", "fully", "includes", "variations", "successfully", "embedded", "realized", "law", "frequencies", "MHz", "losses", "commercial", "modes", "illustrate", "inverter", "dB", "done", "satellite", "harmonic", "characteristic", "errors", "reliable", "chip", "battery", "integral", "designing", "driving", "employing", "electromagnetic", "composed", "closed-loop", "array", "flexible", "end", "sampling", "extended", "whole", "motors", "wave", "amplitude", "simultaneously", "convergence", "disturbances", "fault", "peak", "principle", "fabricated", "currents", "amplifiers", "discrete", "System", "modeled", "states", "charge", "disturbance", "operate", "ensure", "equipment", "reduces", "static", "Since", "deals", "pulse", "uncertainty", "offers", "inputs", "confirm", "market", "coefficients", "Energy", "electronics", "realize", "damping", "generators", "steady-state", "Also", "voltages", "Due", "module", "modulation", "synchronous", "precision", "logic", "stochastic", "fixed", "uncertainties", "filtering", "capacitors", "photovoltaic", "acquisition", "zero", "block", "tuned", "driven", "measuring", "comparing", "proportional", "realization", "W", "nm", "optimize", "Power", "gives", "approximation", "sufficient", "units", "gains", "simplified", "AC", "compact", "square", "whose", "predictive", "closed", "estimates", "MATLAB", "rejection", "low-cost", "fact", "flexibility", "Hz", "excitation", "description", "minimize", "moving", "artificial", "derivative", "x", "transistors", "close", "consisting", "outputs", "proportional-integral-derivative", "illustrated", "employs", "exhibits", "generating", "heating", "three-phase", "resistors", "fractional", "path", "addressed", "PV", "actuator", "discusses", "low-power", "Hence", "chosen", "discrete-time", "consideration", "possibility", "distortion", "0.18", "resistor", "greatly", "board", "capacitance", "superior", "connection", "utilizing", "demonstrates", "transconductance", "blocks", "forward", "oscillator", "receiver", "feasible", "parametric", "programmable", "kHz", "non-linear", "represented", "modal", "verification", "interference", "term", "price", "implementing", "equipped", "criterion", "time-varying", "movement", "offset", "detector", "ideal", "formulated", "inverse", "specifications", "operated", "Lyapunov", "hence", "Kalman", "acceleration", "processor", "RF", "considers", "transistor", "recursive", "investigates", "drives", "switch", "universal", "grounded", "autonomous", "dynamical", "oscillation", "deviation", "existence", "reactive", "estimating", "precise", "Model", "maintain", "consumes", "gate", "inherent", "mW", "Each", "second-order", "PI", "margin", "simulator", "robot", "setup", "added", "width", "current-mode", "unstable", "dc", "FPGA", "complementary", "Simulations", "driver", "Current", "harmonics", "dissipation", "ADC", "constraint", "0.5", "periodic", "GHz", "piezoelectric", "IC", "swarm", "equal", "itself", "sinusoidal", "freedom", "turbines", "resonant", "calibration", "low-voltage", "complicated", "matrices", "track", "incorporated", "observer", "settling", "threshold", "continuous-time", "prices", "silicon", "satisfactory", "specified", "topologies", "attractive", "inductance", "faults", "linearity", "simultaneous", "nominal", "pump", "Its", "high-speed", "overshoot", "compensate", "first-order", "adding", "Gaussian", "nonlinearity", "Electrical", "dual", "PSO", "simplicity", "converted", "pole", "from", "have", "has", "these", "been", "also", "expression", "cells", "cell", "analysis", "gene", "human", "protein", "its", "blotting", "molecular", "showed", "role", "found", "These", "important", "biology", "However", "reaction", "including", "levels", "genes", "chain", "identified", "activity", "could", "metabolism", "revealed", "genetic", "review", "novel", "DNA", "polymerase", "first", "Here", "proteins", "observed", "function", "specific", "detected", "species", "mechanisms", "involved", "PCR", "further", "addition", "samples", "level", "major", "expressed", "demonstrated", "acid", "known", "cancer", "tissue", "understanding", "similar", "Northern", "Southern", "growth", "presence", "confirmed", "enzyme", "vitro", "mRNA", "mechanism", "highly", "factor", "biological", "tissues", "immune", "assay", "quantitative", "determined", "RNA", "functional", "single", "recent", "small", "Furthermore", "sequence", "target", "cellular", "enzymes", "indicated", "regulation", "pathways", "vivo", "blood", "characterized", "induced", "pathway", "via", "therapeutic", "transcription", "genome", "play", "tumor", "plants", "normal", "sequencing", "metabolic", "report", "infection", "previously", "four", "real-time", "family", "resistance", "formation", "isolated", "reverse", "activation", "plant", "signaling", "assays", "ability", "mice", "against", "binding", "lines", "receptor", "essential", "responses", "suggesting", "acids", "RT-PCR", "differentiation", "genomic", "interactions", "virus", "humans", "established", "sequences", "populations", "containing", "amino", "cause", "concentrations", "selected", "molecules", "proliferation", "T", "remains", "markers", "suggested", "together", "genetics", "I", "discuss", "stem", "caused", "host", "enzymology", "recently", "rapid", "mouse", "produced", "inhibition", "liver", "survival", "c", "Thus", "substrate", "bacteria", "products", "culture", "site", "mutations", "resulted", "enhanced", "plays", "regions", "B", "bacterial", "progression", "cDNA", "chemical", "combination", "regulatory", "Western", "synthesis", "transgenic", "physiological", "metabolites", "pattern", "diversity", "unknown", "animals", "Recent", "hybridization", "animal", "unique", "encoding", "line", "compounds", "pathogenesis", "distinct", "nuclear", "plasma", "biochemical", "therefore", "five", "leading", "sensitive", "screening", "northern", "100", "mutation", "inhibitor", "responsible", "sites", "indicating", "viral", "membrane", "conserved", "advances", "strains", "crucial", "inhibited", "phenotype", "remain", "blot", "exhibited", "Molecular", "targets", "diverse", "specificity", "h", "strain", "tumors", "putative", "+", "kinase", "targeting", "targeted", "inhibitors", "six", "led", "food", "potentially", "promoter", "reactions", "insights", "now", "marker", "immunology", "recombinant", "transcripts", "regulated", "induction", "currently", "enzymatic", "situ", "receptors", "accumulation", "induce", "characterization", "apoptosis", "action", "profiles", "discovery", "II", "microscopy", "mitochondrial", "amplification", "western", "stages", "antigen", "staining", "substrates", "antibodies", "cloned", "conclusion", "manner", "intracellular", "rapidly", "urine", "infections", "Additionally", "oxidative", "antibody", "rat", "catalytic", "biosynthesis", "absence", "carcinoma", "spectrometry", "variants", "fluorescence", "medicine", "lipid", "composition", "pathogens", "activated", "overexpression", "understood", "Inc", "immunity", "reveal", "regulate", "upon", "organisms", "medium", "largely", "biomarkers", "represents", "transcriptional", "cultured", "Human", "endogenous", "Several", "coli", "RNAs", "occur", "extracellular", "nucleotide", "valuable", "fatty", "International", "L.", "bp", "alpha", "serve", "muscle", "candidate", "resistant", "Biology", "microbial", "C.", "significance", "characterize", "date", "molecule", "transcript", "cancers", "regulating", "peptide", "pathogenic", "pathogen", "immunohistochemistry", "infected", "worldwide", "metabolite", "residues", "mutant", "selective", "phenotypes", "implicated", "evolutionary", "alterations", "wild-type", "numerous", "tolerance", "2011", "epithelial", "insight", "specimens", "cytometry", "dietary", "mammalian", "copy", "migration", "isolates", "homeostasis", "inhibit", "progress", "release", "ELISA", "isolation", "genotype", "seven", "genotypes", "synthase", "prognosis", "susceptibility", "fragment", "differentially", "Escherichia", "transformed", "polymorphism", "kidney", "secretion", "S.", "genetically", "plasmid", "origin", "probe", "purified", "glucose", "Expression", "gel", "s", "wild", "modification", "broad", "closely", "European", "localization", "studying", "Because", "cytokines", "affecting", "occurs", "cytokine", "fluorescent", "metastasis", "upregulated", "innate", "numbers", "poorly", "leaves", "polymorphisms", "contained", "overview", "compound", "far", "M", "allowed", "reading", "invasion", "potent", "repair", "oxygen", "electrophoresis", "endothelial", "thereby", "toxicity", "intermediate", "suppressed", "biomarker", "member", "Genetic", "chromosome", "newly", "phenotypic", "replication", "regeneration", "E.", "Interestingly", "miRNAs", "renal", "oxidation", "phylogenetic", "native", "microarray", "affinity", "encodes", "organs", "vaccine", "inhibitory", "discovered", "elucidate", "A.", "amounts", "copies", "Taken", "genomes", "variant", "Union", "Biochemistry", "encoded", "sequenced", "physiology", "transplantation", "loci", "frame", "quantification", "reporter", "mechanistic", "repeat", "suppression", "R", "markedly", "methylation", "fragments", "abundant", "investigations", "causing", "embryonic", "cytochrome", "P.", "recognized", "phosphorylation", "g", "mature", "high-throughput", "cultures", "regulates", "hydrolysis", "elucidated", "probes", "regulator", "abundance", "screened", "on", "which", "at", "C", "design", "Elsevier", "rights", "reserved", "materials", "into", "process", "high", "2016", "engineering", "developed", "well", "conditions", "flow", "work", "Ltd.", "It", "experimental", "models", "obtained", "properties", "machine", "temperature", "surface", "efficiency", "manufacturing", "out", "fluid", "engine", "strength", "structure", "investigated", "pressure", "internal", "combustion", "will", "within", "characteristics", "mechanical", "considered", "numerical", "thermal", "heat", "rate", "processes", "test", "For", "studied", "carried", "Published", "mechanics", "ratio", "stress", "modeling", "production", "measurements", "size", "density", "maximum", "Engineering", "distribution", "gas", "equations", "fuel", "theory", "element", "finite", "because", "good", "computer-aided", "velocity", "reduction", "calculated", "point", "hydraulics", "volume", "critical", "along", "degrees", "methodology", "machines", "part", "thermodynamics", "hydraulic", "3D", "form", "means", "University", "geometry", "mass", "basis", "boundary", "equation", "Ltd", "account", "cycle", "combined", "analytical", "length", "initial", "resulting", "increases", "product", "air", "transport", "thermodynamic", "predict", "force", "channel", "flux", "advanced", "Manufacturing", "parts", "working", "detailed", "industrial", "torque", "decrease", "component", "temperatures", "necessary", "shape", "Materials", "variation", "emissions", "vehicle", "include", "lead", "agreement", "larger", "flows", "vehicles", "calculation", "fundamental", "shear", "three-dimensional", "free", "permanent", "points", "laboratory", "must", "CAD", "deformation", "testing", "produce", "loading", "investigation", "steel", "technical", "failure", "engines", "rotor", "particle", "Design", "magnet", "evolution", "liquid", "core", "diameter", "typical", "here", "full", "depth", "compression", "metal", "calculations", "surfaces", "relatively", "fracture", "modelling", "solid", "angle", "cooling", "final", "cylinder", "phenomena", "designs", "varying", "contact", "On", "simulate", "kinetics", "leads", "Mechanical", "inside", "wall", "emission", "subject", "stresses", "electron", "exhaust", "decreases", "utilized", "limit", "predictions", "special", "transition", "recovery", "direction", "particles", "forces", "thickness", "phases", "depends", "hydrogen", "injection", "principles", "taking", "Technology", "short", "entropy", "friction", "near", "accurately", "innovative", "student", "optimum", "kinetic", "assembly", "formulation", "entire", "limitations", "geometric", "tensile", "CFD", "excellent", "fluids", "stator", "two-dimensional", "phenomenon", "equilibrium", "From", "magnitude", "0", "reactor", "scanning", "oil", "elastic", "solved", "distributions", "axial", "subjected", "detail", "scales", "proper", "CO2", "dependent", "laser", "downstream", "diffusion", "formed", "morphology", "radial", "smaller", "discharge", "configurations", "X-ray", "cycles", "turbulent", "fabrication", "beam", "height", "depending", "ignition", "limits", "Numerical", "adsorption", "hot", "pressures", "fraction", "dependence", "Institute", "calculate", "microstructure", "expansion", "automotive", "Reynolds", "regime", "aided", "viscosity", "fatigue", "curves", "determining", "courses", "K", "ICE", "steady", "porous", "diesel", "Analysis", "procedures", "predicting", "manufacture", "determination", "physics", "engineers", "Computational", "pure", "winding", "zone", "plastic", "inlet", "comparative", "alloy", "plane", "polymer", "composites", "uniform", "2D", "choice", "reach", "bulk", "bending", "machining", "pipe", "speeds", "mixture", "forming", "residual", "geometries", "e.g", "exchange", "defects", "drop", "scaling", "down", "alloys", "developments", "FEM", "horizontal", "roughness", "valve", "velocities", "center", "momentum", "stream", "viscous", "dimensional", "bed", "already", "crack", "geometrical", "aqueous", "gasoline", "numerically", "outer", "gradient", "MPa", "channels", "governing", "printing", "next", "aspect", "sections", "Finite", "plate", "head", "cutting", "starting", "diffraction", "assumed", "responsibility", "slightly", "introduction", "turbulence", "PM", "Department", "guide", "reasonable", "chamber", "hydrodynamic", "gases", "tube", "modulus", "fuels", "oxide", "regimes", "wear", "mixing", "reached", "intended", "deposition", "quantities", "tension", "grain", "manufactured", "inner", "shapes", "waves", "considerations", "Selection", "finite-element", "laws", "homogeneous", "sediment", "radius", "upstream", "reason", "iron", "onto", "depend", "valves", "one-dimensional", "piston", "specimen", "crystal", "hardness", "ceramic", "greenhouse", "metallic", "Strength", "axis", "magnets", "convection", "mixtures", "implant", "additive", "companies", "School", "reluctance", "preparation", "extremely", "curriculum", "coolant", "walls", "boundaries", "copper", "follows", "timing", "CAD/CAM", "implants", "jet", "fit", "printed", "undergraduate", "spark", "bar", "XRD", "Various", "hole", "assumptions", "reaches", "thermal-hydraulics", "angles", "bottom", "viable", "methodologies", "cylindrical", "glass", "comparisons", "fluctuations", "Laboratory", "peer-review", "Fluid", "dioxide", "compressive", "porosity", "modelled", "flood", "mobility", "Integrated", "diameters", "sheet", "gravity", "Chemical", "Navier-Stokes", "pumping", "constitutive", "conjunction", "owing", "cooled", "lengths", "contents", "accounting", "bonding", "Delta", "unsteady", "FEA", "vessel", "rigid", "reactors", "moment", "drag", "Mechanics", "acceptable", "consequence", "wood", "simulating", "nearly", "Aided", "satisfy", "toughness", "gradients", "placement", "vortex", "corrosion", ",", "that", "or", "between", "not", "their", "more", "research", "but", "'s", "than", "both", "studies", "'", "social", "findings", "other", "effects", "about", "during", "participants", "who", "when", "disorder", "they", "how", "effect", "whether", "suggest", "behavior", "among", "related", "examined", "only", "evidence", "differences", "those", "relationship", "disorders", "individuals", "positive", "support", "sample", "attention", "there", "less", "negative", "children", "people", "cognitive", "gender", "did", "impact", "across", "influence", "measures", "literature", "examine", "discussed", "emotional", "depression", "article", "greater", "personality", "mental", "early", "analyses", "individual", "implications", "life", "context", "likely", "''", "behaviors", "completed", "``", "often", "task", "being", "physical", "Participants", "communication", "brain", "child", "psychological", "Although", "general", "roles", "others", "either", "students", "behavioral", "female", "relationships", "exposure", "memory", "experience", "adults", "suggests", "however", "affect", "focus", "abuse", "scores", "importance", "interaction", "male", "perceived", "violence", "predicted", "particularly", "variables", "men", "interventions", "anxiety", "previous", "whereas", "regarding", "psychiatric", "might", "do", "especially", "young", "N", "would", "strategies", "Using", "if", "education", "adolescents", "associations", "Inc.", "sexual", "i.e.", "perception", "little", "schizophrenia", "explore", "affective", "toward", "experiences", "patterns", "measure", "adult", "Study", "underlying", "community", "attitudes", "relevant", "developing", "contribute", "positively", "relative", "public", "depressive", "functioning", "cognition", "traits", "lack", "light", "consistent", "media", "condition", "aspects", "what", "prenatal", "eating", "Findings", "While", "Scale", "skills", "hypothesis", "content", "focused", "relation", "interviews", "mood", "contrast", "nonverbal", "childhood", "strong", "understand", "yet", "emotion", "e.g.", "recognition", "few", "mediated", "neural", "person", "prosocial", "towards", "violent", "later", "leadership", "antisocial", "Method", "consequences", "developmental", "Research", "perceptions", "aggression", "perspective", "parents", "explored", "deficits", "rather", "false", "females", "nature", "examines", "prior", "although", "past", "emotions", "members", "extent", "Further", "differ", "behaviour", "ways", "school", "personal", "cultural", "qualitative", "males", "influences", "forms", "interpersonal", "negatively", "experienced", "linked", "empirical", "cortex", "aggressive", "verbal", "substance", "questions", "highlight", "video", "bias", "programs", "central", "When", "memories", "specifically", "own", "stimuli", "spectrum", "dimensions", "Questionnaire", "longitudinal", "borderline", "another", "settings", "items", "examining", "Despite", "validity", "course", "paradigm", "relations", "strongly", "illness", "exposed", "influenced", "subsequent", "degree", "Social", "Implications", "face", "rated", "identity", "They", "trait", "predictors", "participated", "prejudice", "Overall", "controlling", "difficulties", "explain", "theories", "Children", "contexts", "reports", "link", "families", "neutral", "authors", "facial", "assessing", "political", "cues", "promote", "?", "ratings", "psychopathology", "problem-solving", "supported", "themselves", "stronger", "adolescent", "temporal", "beliefs", "right", "asked", "involving", "hypothesized", "game", "Studies", "society", "questionnaires", "argue", "concerns", "parental", "question", "self-reported", "generally", "explained", "Depression", "Disorder", "maternal", "supporting", "appears", "appear", "correlations", "impaired", "Previous", "engage", "BPD", "beyond", "distress", "seasonal", "categories", "concerning", "self-report", "Specifically", "alcohol", "actions", "altered", "clear", "b", "left", "professional", "educational", "despite", "finding", "abilities", "identifying", "words", "explores", "games", "prefrontal", "youth", "mixed", "awareness", "mothers", "opportunities", "trauma", "emerged", "nervosa", "maltreatment", "partner", "Assessment", "affects", "faces", "autism", "Three", "reflect", "discrimination", "professionals", "well-being", "conclude", "situations", "engagement", "bipolar", "Inventory", "correlates", "concern", "adulthood", "Periodicals", "ages", "place", "turn", "showing", "empathy", "girls", "variance", "psychosocial", "Child", "satisfaction", "directions", "interview", "expectations", "decisions", "Experiment", "sense", "participation", "subjective", "orientation", "viewed", "teachers", "predictor", "assessments", "recall", "psychology", "offer", "behavioural", "primarily", "perspectives", "academic", "assigned", "feelings", "moral", "adolescence", "neglect", "why", "displayed", "comorbid", "judgments", "mind", "highlights", "true", "third", "motivation", "Future", "themes", "behaviours", "Test", "conduct", "discussion", "expressions", "implicit", "conflict", "regard", "norms", "goals", "thought", "impairments", "consisted", "Given", "anorexia", "suicide", "stereotypes", "reporting", "thinking", "event", "partially", "leaders", "indirect", "investigating", "diagnoses", "exhibit", "competence", "attempts", "Ireland", "Personality", "fewer", "his", "self", "peers", "conceptual", "engaged", "sessions", "evaluations", "earlier", "parent", "causal", "focusing", "everyday", "relevance", "though", "peer", "seems", "partners", "eye", "executive", "threat", "decision-making", "act", "organizational", "criminal", "boys", "psychosis", "Limitations", "frontal", "fear", "brief", "team", "systematically", "moderated", "psychotic", "nor", "tendency", "Disorders", "cortical", "anterior", "Eating", "just"}
VOCAB = {"this", "In", "we", "can", "data", "We", "it", "method", "such", "algorithm", "our", "new", "show", "two", "approach", "computer", "information", "present", "one", "methods", "applications", "problem", "propose", "To", "number", "algorithms", "software", "each", "provide", "processing", "computing", "many", "Our", "set", "large", "learning", "techniques", "image", "some", "several", "security", "existing", "various", "efficient", "while", "problems", "solutions", "features", "demonstrate", "programming", "parallel", "distributed", "framework", "where", "implementation", "structures", "provides", "accuracy", "improve", "multiple", "complex", "then", "computational", "better", "key", "very", "experiments", "computation", "approaches", "any", "them", "same", "real", "images", "available", "networks", "detection", "As", "terms", "result", "possible", "need", "tool", "knowledge", "so", "user", "allows", "evaluation", "way", "traditional", "space", "With", "functions", "Moreover", "databases", "users", "called", "vision", "tools", "database", "and", ")", "(", "were", "was", "study", ":", "patients", "%", "Results", ";", "associated", "may", "treatment", "Methods", "disease", "significant", "significantly", "=", "clinical", "had", "years", "compared", "increased", "risk", "after", "age", "all", "Conclusions", "higher", "Background", "2", "health", "most", "1", "<", "no", "factors", "group", "total", "included", "reported", "Conclusion", "groups", "3", "lower", "performed", "therapy", "care", "respectively", "symptoms", "common", "patient", "assessed", "population", "should", "without", "women", "p", "conducted", "aim", "95", "2017", "There", "outcomes", "association", "diagnosis", "changes", "evaluated", "mean", "diseases", "chronic", "P", "evaluate", "Objective", "primary", "assess", "determine", "[", "]", "10", "regression", "months", "investigate", "decreased", "measured", "4", "reduced", "CI", "healthy", "identify", "cases", "period", "6", "5", "type", "treated", "prevalence", "aimed", "Patients", "All", "water", "different", "use", "construction", "through", "management", "development", "under", "potential", "due", "building", "material", "area", "environmental", "three", "application", "environment", "over", "main", "field", "technology", "harvesting", "increase", "case", "quality", "B.V.", "areas", "pollution", "effective", "green", "smart", "rainwater", "project", "change", "solar", "soil", "bridge", "monitoring", "future", "geotextile", "analyzed", "2015", "sensing", "projects", "increasing", "sustainable", "natural", "up", "buildings", "tests", "remote", "resources", "structural", "local", "value", "assessment", "indicate", "suspension", "made", "technologies", "capacity", "industry", "Based", "demand", "spatial", "purpose", "2014", "activities", "urban", "economic", "average", "China", "region", "global", "ambient", "scale", "sources", "climate", "land", "impacts", "aims", "Water", "storage", "rainfall", "-", "objective", "concentration", "improvement", "layer", "sensors", "alternative", "sustainability", "2013", "benefits", "mainly", "promising", "bridges", "composite", "series", "is", "are", "paper", "This", "system", "proposed", "using", "control", "power", "A", "model", "performance", "systems", "electrical", "presented", "time", "presents", "current", "energy", "parameters", "order", "simulation", "signal", "circuit", "voltage", "frequency", "controller", "output", "designed", "network", "low", "circuits", "applied", "technique", "dynamic", "input", "electric", "digital", "linear", "range", "operation", "response", "implemented", "state", "load", "nonlinear", "motor", "operational", "conventional", "amplifier", "analog", "solution", "shown", "consumption", "filter", "cost", "electricity", "PID", "simulations", "identification", "optimization", "generation", "stability", "supply", "An", "Finally", "representation", "speed", "optimal", "simple", "effectiveness", "CMOS", "integrated", "given", "generator", "active", "error", "gain", "microcontroller", "components", "operating", "required", "controlled", "scheme", "achieve", "measurement", "phase", "reduce", "converter", "parameter", "feedback", "suitable", "signals", "noise", "derived", "dynamics", "proposes", "devices", "mu", "mode", "from", "have", "has", "these", "been", "also", "expression", "cells", "cell", "analysis", "gene", "human", "protein", "its", "blotting", "molecular", "showed", "role", "found", "These", "important", "biology", "However", "reaction", "including", "levels", "genes", "chain", "identified", "activity", "could", "metabolism", "revealed", "genetic", "review", "novel", "DNA", "polymerase", "first", "Here", "proteins", "observed", "function", "specific", "detected", "species", "mechanisms", "involved", "PCR", "further", "addition", "samples", "level", "major", "expressed", "demonstrated", "acid", "known", "cancer", "tissue", "understanding", "similar", "Northern", "Southern", "growth", "presence", "confirmed", "enzyme", "vitro", "mRNA", "mechanism", "highly", "factor", "biological", "tissues", "immune", "assay", "quantitative", "determined", "RNA", "functional", "single", "recent", "small", "Furthermore", "sequence", "target", "cellular", "enzymes", "indicated", "regulation", "pathways", "vivo", "blood", "characterized", "induced", "pathway", "via", "therapeutic", "transcription", "on", "which", "at", "C", "design", "Elsevier", "rights", "reserved", "materials", "into", "process", "high", "2016", "engineering", "developed", "well", "conditions", "flow", "work", "Ltd.", "It", "experimental", "models", "obtained", "properties", "machine", "temperature", "surface", "efficiency", "manufacturing", "out", "fluid", "engine", "strength", "structure", "investigated", "pressure", "internal", "combustion", "will", "within", "characteristics", "mechanical", "considered", "numerical", "thermal", "heat", "rate", "processes", "test", "For", "studied", "carried", "Published", "mechanics", "ratio", "stress", "modeling", "production", "measurements", "size", "density", "maximum", "Engineering", "distribution", "gas", "equations", "fuel", "theory", "element", "finite", "because", "good", "computer-aided", "velocity", "reduction", "calculated", "point", "hydraulics", "volume", "critical", "along", "degrees", "methodology", "machines", "part", "thermodynamics", "hydraulic", "3D", "form", "means", "University", "geometry", "mass", "basis", "boundary", "equation", "Ltd", "account", "cycle", ",", "that", "or", "between", "not", "their", "more", "research", "but", "'s", "than", "both", "studies", "'", "social", "findings", "other", "effects", "about", "during", "participants", "who", "when", "disorder", "they", "how", "effect", "whether", "suggest", "behavior", "among", "related", "examined", "only", "evidence", "differences", "those", "relationship", "disorders", "individuals", "positive", "support", "sample", "attention", "there", "less", "negative", "children", "people", "cognitive", "gender", "did", "impact", "across", "influence", "measures", "literature", "examine", "discussed", "emotional", "depression", "article", "greater", "personality", "mental", "early", "analyses", "individual", "implications", "life", "context", "likely", "''", "behaviors", "completed", "``", "often", "task", "being", "physical", "Participants", "communication", "brain", "child", "psychological", "Although", "general", "roles", "others", "either", "students", "behavioral", "female", "relationships", "exposure", "memory", "experience", "adults", "suggests", "however", }

LABELS = {"CS":0, "Medical":1, "Civil":2, "ECE":3, "biochemistry":4, "MAE":5, "Psychology ":6}

def countVocab(sentence, label):
	wordsAdded = []
	for i in sentence:
		key = DATA.get(label)
		if key == None:
			DATA[label] = {i:1}
			wordsAdded.append(i)
		else:
			keyVocab = key.get(i)
			if keyVocab == None:
				key[i] = 1
			elif i not in wordsAdded:
				key[i] = keyVocab + 1
				wordsAdded.append(i)

def getData():
	None

def main():

	mainData = pickle.load(open("XY_WOS.p", "rb"))
	X = mainData[0]
	Y = mainData[1]
	X_test = mainData[2]
	Y_test = mainData[3]
	'''
	mainData = pickle.load(open("WOS.p", "rb"))
	# print(len(mainData))
	margin = len(mainData) * .2
	flip = 0
	X = []
	Y = []

	X_test = []
	Y_test = []
	counter = 0
	for i in mainData:
		feature = {}
		for j in VOCAB:
			feature[j] = 0
		
		# sentence = i[0].split(" ")
		sentence = list(word_tokenize(i[0]))
		# countVocab(sentence, i[1][0])
		# print(i)
		# print("\n------------------------------------\n")
		# key = FILES_PER_LABEL.get(i[1][0])
		# if key == None:
		# 	FILES_PER_LABEL[i[1][0]] = 1
		# else:
		# 	FILES_PER_LABEL[i[1][0]] = key + 1
		for j in sentence:
			key = feature.get(j)
			if key != None:
				feature[j] = 1
		if flip % 5 != 0:
		# if counter < margin:
			X.append(list(feature.values()))
			Y.append(LABELS[i[1][0]])
		else:
			X_test.append(list(feature.values()))
			Y_test.append(LABELS[i[1][0]])

		counter = counter + 1
		flip = flip + 1

	# print(FILES_PER_LABEL)
	# counter = 0
	# print("{", end = "")
	# for i in FILES_PER_LABEL:
	# 	print ("\"" + i + "\":" + str(counter) + ", ", end = "")
	# 	counter = counter + 1
	# print("}")
	# exit()
	X = np.array(X)
	Y = np.array(Y)
	print(X.shape)
	print(X)
	print(Y.shape)
	print(Y)

	X_test = np.array(X_test)
	Y_test = np.array(Y_test)
	stuff = [X, Y, X_test, Y_test]
	pickle.dump(stuff, open("XY_WOS.p", "wb" ))
	'''
	train_tensor = tf.data.Dataset.from_tensor_slices((X, Y))
	test_tensor = tf.data.Dataset.from_tensor_slices((X_test, Y_test))
	train_batch = train_tensor.shuffle(len(X)).batch(BATCH_SIZE)
	test_batch = test_tensor.shuffle(len(X_test)).batch(BATCH_SIZE)
	# log_reg = LogisticRegression(multi_class="multinomial",solver="lbfgs", C=1, max_iter=1000)

	# Fit the model
	print("FITTING THE DATA")
	# log_reg.fit(X, Y)
	nn_clf = tf.keras.Sequential([
		tf.keras.layers.Dense(700, input_dim = NUM_FEATURES, activation = "relu"),
		tf.keras.layers.Dense(500, activation = "relu"),
		tf.keras.layers.Dense(300, activation = "relu"),
		tf.keras.layers.Dense(100, activation = "relu"),
		tf.keras.layers.Dense(50, activation = "relu"),
		tf.keras.layers.Dense(20, activation = "relu"),
		tf.keras.layers.Dense(NUM_LABELS, activation = "softmax")
    ]) 

    # Can also use sparse_categorical_accuracy as a metric
	nn_clf.compile(optimizer=tf.keras.optimizers.RMSprop(learning_rate=1e-3), loss='sparse_categorical_crossentropy', metrics=['mean_squared_error'])
	#nn_clf.compile(optimizer=tf.keras.optimizers.RMSprop(learning_rate=1e-3), loss='sparse_categorical_crossentropy', metrics=['sparse_categorical_accuracy'])
	
	nn_clf_history = nn_clf.fit(train_batch, epochs = EPOCHS)

	# Make prediction
	print("MAKING PREDICTIONS")
	# Y_pred = log_reg.predict(X_test)
	test_predictionsNN = nn_clf.predict_classes(X_test)




	# Calculate accuracy, precision, and recall
	print("PRINTING STATISTICS")
	acc = accuracy_score(y_true = Y_test, y_pred = test_predictionsNN)
	prec = precision_score(y_true = Y_test, y_pred = test_predictionsNN, average = "macro")
	recall = recall_score(y_true = Y_test, y_pred = test_predictionsNN, average = "macro")
	print ("accuracy = " + str(acc))
	print ("precision = " + str(prec))
	print ("recall = " + str(recall))

	# VOCAB = {}
	# for i in DATA:
	# 	print ("--------------------------")
	# 	print (i + "\t" + str(FILES_PER_LABEL[i]))
	# 	print ("--------------------------")

	# 	sortedList = sorted(DATA[i].items(), key=lambda x: x[1], reverse=True)
	# 	for j in range(500):
	# 		print(str(j + 1) + ".\t" + sortedList[j][0] + "\t\t" + str(sortedList[j][1]))
			# VOCAB[sortedList[j][0]] = 0
		# print("")
	# print("[", end = "")
	# for i in VOCAB:
	# 	print ("\"" + i + "\", ", end = "")
	# print("]")



	
main()
